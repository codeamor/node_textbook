# 노드의 정의
- Node.js는 크롬 V8 자바스크립트 엔진으로 빌드된 자바스크립트 런타임입니다.

> 노드는 서버가 아닌가?
- 서버의 역할도 수행할 수 있는 자바스크립트 런타임
- 노드로 자바스크립트로 작성된 서버를 실행할 수 있습니다.
- 서버 실행을 위해 필요한 http/https/http2 모듈을 제공합니다.

> 노드가 등장하기 전 자바스크립트는 어떻게 구동되었는가?
- HTML 및 브라우저가 있어야만 자바스크립트를 실행할 수 있었습니다.
- 노드의 등장으로 그 종속성에서 벗어나게 되었습니다.

## 런타임
- 런타임: 특정 언어로 만든 프로그램들을 실행할 수 있게 해주는 가상 머신(크롬의 V8 엔진 사용)의 상태

## 내부 구조
- C나 C++로 짜여져 있다. (내부 구조성능 우위 but 생산성 부족으로 JS 도입)
- Java에서는 멀티 스레딩으로 프로그래밍 난이도 높음, 노드는 싱글 스레드, 이벤트 기반으로 비교적 초보들에게 접근성에서 우위를 가집니다.

# 노드의 특성

## 1. 이벤트 기반
> 이벤트가 발생할 때 미리 지정해둔 작업을 수행하는 방식

## 2. 논블로킹 I/O
> 오래 걸리는 함수를 백그라운드로 보내서 다음 코드가 먼저 실행되게 하고, 나중에 오래 걸리는 함수를 실행
- 논블로킹 방식에선 일부 코드가 백그라운드에서 병렬로 실행됩니다.
  - 일부 코드: I/O 작업(파일 시스템 접근, 네트워크 요청), 압축, 암호화 등
- 나머지 코드는 블로킹 방식으로 실행됩니다.
- I/O 작업이 많을 때 노드 활용성이 극대화 됩니다.

> 블로킹이면 동기 & 논블로킹이면 비동기
- 항상 참은 아니지만 노드에서는 대부분 참인 명제입니다.
- 흔히들 비동기 상황에서 노드가 프로그램을 동시에 실행한다고 생각하지만 노드에서 동시를 구현하는 것은 매우 힘듭니다. -> 일부 코드만 숙지
- 논블로킹이라고 해서 랜덤으로 실행되는 것이 아니라 실행 컨텍스트에 의지하게 됩니다.

## 3. 프로레스 vs 스레드
- 프로세스: 운영체제에서 할당하는 작업의 단위, 프로세스 간 자원 공유X (마치 크롬에서 여러 탭을 띄우는 것, 크롬이라는 프로그램에서 탭들이 스레드라고 생각하면 편함)
- 스레드: 프로세스 내에서 실행되는 작업의 단위, 부모 프로세스 자원 공유

> 노드 프로세스는 멀티 스레드이지만 직접 다룰 수 있는 스레드는 하나이기 때문에 싱글 스레드라고 표현합니다.

> 노드는 주로 멀티 스레드 대신 멀티 프로세스를 활용합니다.
- 노드는 14버전부터 멀티 스레드 사용 가능
- 멀티 스레드를 하면 동시에 작업이 가능합니다. (ex. 인스타, 페북 동시 사용)
- 논블로킹 -> 코드가 동시에 안돌아감
-> 노드의 스레드 하나가 가동되면 나머지 3개의 스레드는 대기하게 됩니다.

## 4. 싱글 스레드
> 싱글 스레드라 주어진 일을 하나밖에 처리하지 못합니다.
- 블로킹이 발생하면 나머지 작업은 모두 대기해야 함 -> 비효율

## 5. 멀티 스레드 모델과 비교하면?
> 싱글 스레드 모델은 에러를 처리하지 못하는 경우엔 멈춥니다.
- 프로그래밍 난이도가 쉽고, CPU, 메모리 자원을 적게 사용합니다.

> 멀티 스레드 모델은 에러 발생 시 새로운 스레드를 생성하여 극복합니다.
- 단, 새로운 스레드 생성이나 놀고 있는 스레드 처리에 비용이 발생합니다
- 스레드 수만큼 자원을 많이 사용합니다.

## 6. 멀티 스레드의 활용
> 노드 14버전
- 멀티 스레드를 사용할 수 있도록 worker_threads 모듈 도입
- CPU를 많이 사용하는 작업인 경우에 활용 가능
- 멀티 프로세싱만 가능했던 아쉬움을 달래줌.
  - 원래는 체인점 내는 것만 가능했는데, 한 가게에서 여러가지 일을 수행할 수 있게 되었습니다.
- 하지만 노드에서 멀티 스레딩은 메인이 아니라 어디까지나 선택 사항입니다.
![ex_screenshot](./img/threadingVersusProcessing.JPG)
